"use strict";
var __assign = (this && this.__assign) || Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
            t[p] = s[p];
    }
    return t;
};
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = __importStar(require("react"));
var react_helmet_1 = __importDefault(require("react-helmet"));
var server_1 = require("react-dom/server");
var react_serialize_1 = require("@shopify/react-serialize");
var components_1 = require("./components");
function HTML(_a) {
    var _b = _a.children, children = _b === void 0 ? '' : _b, _c = _a.blockingScripts, blockingScripts = _c === void 0 ? [] : _c, _d = _a.scripts, scripts = _d === void 0 ? [] : _d, _e = _a.styles, styles = _e === void 0 ? [] : _e, _f = _a.data, data = _f === void 0 ? {} : _f, _g = _a.headData, headData = _g === void 0 ? {} : _g, hideForInitialLoad = _a.hideForInitialLoad;
    var markup = server_1.renderToString(children);
    var helmet = react_helmet_1.default.renderStatic();
    var htmlAttributes = helmet.htmlAttributes.toComponent();
    var bodyAttributes = helmet.bodyAttributes.toComponent();
    var stylesMarkup = styles.map(function (style) {
        return (React.createElement(components_1.Style, { key: style.path, href: style.path, integrity: style.integrity, crossOrigin: "anonymous" }));
    });
    var blockingScriptsMarkup = blockingScripts.map(function (script) {
        return (React.createElement(components_1.Script, { key: script.path, src: script.path, integrity: script.integrity, crossOrigin: "anonymous" }));
    });
    var deferredScriptsMarkup = scripts.map(function (script) {
        return (React.createElement(components_1.Script, { key: script.path, src: script.path, integrity: script.integrity, crossOrigin: "anonymous", defer: true }));
    });
    /* eslint-disable no-undefined */
    var bodyStyles = hideForInitialLoad ? { display: 'none' } : undefined;
    /* eslint-enable no-undefined */
    var headDataMarkup = Object.keys(headData).map(function (id) {
        return React.createElement(react_serialize_1.Serializer, { key: id, id: id, data: headData[id] });
    });
    var dataMarkup = Object.keys(data).map(function (id) {
        return React.createElement(react_serialize_1.Serializer, { key: id, id: id, data: data[id] });
    });
    return (React.createElement("html", __assign({ lang: "en" }, htmlAttributes),
        React.createElement("head", null,
            helmet.title.toComponent(),
            helmet.meta.toComponent(),
            helmet.script.toComponent(),
            helmet.link.toComponent(),
            stylesMarkup,
            headDataMarkup,
            blockingScriptsMarkup),
        React.createElement("body", __assign({}, bodyAttributes, { style: bodyStyles }),
            React.createElement("div", { id: "app", style: { height: '100%' }, dangerouslySetInnerHTML: { __html: markup } }),
            dataMarkup,
            deferredScriptsMarkup)));
}
exports.default = HTML;
